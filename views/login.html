
<div class="form-login">
    <% if(typeof(error) !== 'undefined' && error){ %>
    <div class="alert alert-error">
        <a class="close" data-dismiss="alert" href="#">&times;</a>
        <strong><%= error %></strong>
    </div>
    <% } %>
    <form id='signin_form' class='form-horizontal' action='/login' method='post'>
        <div class='control-group'>
            <label class='control-label' for='name'>用户名</label>

            <div class='controls'>
                <input class='input-xlarge' id='name' name='name' size='30' type='text'/>
            </div>
        </div>
        <div class='control-group'>
            <label class='control-label' for='pass'>密码</label>

            <div class='controls'>
                <input class='input-xlarge' id='pass' name='pass' size='30' type='password'/>
            </div>
        </div>
        <div class="validate-img">
            <img src="<%= imgdata %>" alt="点击刷新" />
            <input class="img-value" name="valida_img" type="text"/>
        </div>

        <div class='form-actions'>
            <input type='submit' class='span-primary' value='登录'/>
        </div>
    </form>
</div>
<script type="text/javascript">
    $('.validate-img img').click(function (e) {
        var $this = $(this);
        $.ajax({
            url:'/login/validate_img',
            method:'post'
        }).done(function (data) {
            $this.attr('src',data.imgdata);
        }).fail(function (xhr) {
            if (xhr.status === 403) {
                alert('服务器错误。');
            }
        });
    });
</script>